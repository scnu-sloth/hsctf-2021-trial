
N = 8
M = [9530281573991126869, 16968150138575267893, 17766734670940897570, 10961868430066885229, 14541311909632720933, 17085188397343521115, 16372215539280934197, 14139407420367658549]
Ss = [68192288746140620775, 66361385116492407511, 48874292229883824012, 82331696166508279324, 90749688108864364371, 47479773098223860639, 74377472569583430174, 45696753239583050692, 49276196719148886396, 65959480627227345127, 62068968778863984889, 90068141835266987916, 63415604139516544945, 76208376199231643438, 90068141835266987916, 80500792536860066060, 74377472569583430174, 90068141835266987916, 82331696166508279324, 63415604139516544945, 62068968778863984889, 66361385116492407511, 68192288746140620775, 62068968778863984889, 63415604139516544945, 65959480627227345127, 82733600655773341708, 51820073206859686578, 65765450517198073815, 91462660966926951289]

flag = ''
v1 = vector(ZZ, [1 for i in range(9)])
#D = diagonal_matrix(ZZ, [1, 1, 1, 1, 1, 1, 1, 1, 2^64])
for S in Ss:
  Mt = matrix([
      [1, 0, 0, 0, 0, 0, 0, 0, M[0]],
      [0, 1, 0, 0, 0, 0, 0, 0, M[1]],
      [0, 0, 1, 0, 0, 0, 0, 0, M[2]],
      [0, 0, 0, 1, 0, 0, 0, 0, M[3]],
      [0, 0, 0, 0, 1, 0, 0, 0, M[4]],
      [0, 0, 0, 0, 0, 1, 0, 0, M[5]],
      [0, 0, 0, 0, 0, 0, 1, 0, M[6]],
      [0, 0, 0, 0, 0, 0, 0, 1, M[7]],
      [1, 1, 1, 1, 1, 1, 1, 1, S]
      ])
  L = Mt.LLL()
  b = vector(ZZ, L[0])

  if b[0]==1:
    b = v1-b
  x = ''.join([str(a) for a in list(b)[:8]])
  x = chr(int(x, 2))
  flag += x
  print(x)
print(flag)
